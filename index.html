<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Camera Max Resolution Probe</title>

<style>
html,body{
  margin:0;
  height:100%;
  background:#000;
  color:#0f0;
  font-family:monospace;
}
#bar{
  padding:8px;
  background:rgba(0,0,0,.7);
}
video{
  display:block;
  margin:auto;
}
</style>
</head>

<body>
<div id="bar">
  <div id="info">start</div>
  <button id="start">開始</button>
</div>

<video id="v" playsinline muted></video>

<script>
const v = document.getElementById('v');
const info = document.getElementById('info');
const btn = document.getElementById('start');

btn.onclick = async ()=>{
  try{
    const stream = await navigator.mediaDevices.getUserMedia({
      video:{
        facingMode:{ideal:'environment'},
        width:{ exact:3840 },
        height:{ exact:2160 }
      },
      audio:false
    });
    v.srcObject = stream;
    await v.play();

    const t = stream.getVideoTracks()[0];
    const s = t.getSettings();
    info.textContent = `GRANTED ${s.width} x ${s.height}`;
  }catch(e){
    info.textContent = `FAILED: ${e.name}`;
  }
};
</script>
</body>
</html>
