<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>QR 年賀状 AR（非Canvas版）</title>

<style>
html,body{
  margin:0; background:#000; height:100%; overflow:hidden;
}
#cam{
  position:fixed;
  inset:0;
  object-fit:contain; /* ←ここ超重要 */
}
#overlay{
  position:fixed;
  inset:0;
  pointer-events:none;
  display:none;
}
#start{
  position:fixed;
  z-index:10;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  padding:16px 24px;
  font-size:18px;
}
</style>
</head>

<body>

<button id="start">開始</button>

<video id="cam" playsinline muted></video>

<video id="overlay" src="./overlay.mp4" loop muted playsinline></video>
<audio id="bgm" src="./sound.mp3" loop></audio>

<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>

<script>
const cam = document.getElementById('cam');
const overlay = document.getElementById('overlay');
const bgm = document.getElementById('bgm');
const btn = document.getElementById('start');

btn.onclick = async ()=>{
  btn.style.display='none';

  const stream = await navigator.mediaDevices.getUserMedia({
    video:{
      facingMode:{ideal:'environment'},
      width:{ideal:1280},
      height:{ideal:720}
    },
    audio:false
  });

  cam.srcObject = stream;
  await cam.play();

  overlay.play();
  bgm.play();

  overlay.style.display='block';
};
</script>

</body>
</html>
